<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="fun.neverth.dao.UserDao" >

    <resultMap id="BaseResultMap" type="fun.neverth.bean.po.User" >
        <id column="user_id" property="user_id" />
        <result column="user_account" property="user_account" />
        <result column="user_passw" property="user_passw" />
        <result column="user_last_login" property="user_last_login" />
    </resultMap>

    <sql id="tb">user</sql>
    <sql id="Base_Column_List">
        user_account,  user_passw, user_last_login
    </sql>


    <select id="selectAllUser" resultMap="BaseResultMap">
        select * from <include refid="tb"/>
    </select>
    <select id="selectUserById" resultMap="BaseResultMap" parameterType="fun.neverth.bean.po.User">
        select * from <include refid="tb"/>
        <where>
            and user_id = #{user.user_id}
        </where>
    </select>
    <select id="selectUserByAccount" resultMap="BaseResultMap" parameterType="fun.neverth.bean.po.User">
        select * from <include refid="tb"/>
        <where>
            and user_account = #{user.user_account}
        </where>
    </select>

    <insert id="insertUser"
            parameterType="fun.neverth.bean.po.User"
            useGeneratedKeys="true" keyProperty="user.user_id">
        insert into <include refid="tb"/> ( <include refid="Base_Column_List"/> )
        values (#{user.user_account}, #{user.user_passw}, #{user.user_last_login})
    </insert>

    <delete id="deleteUserById"
            parameterType="fun.neverth.bean.po.User">
        delete from <include refid="tb"></include>
        <where>
            and user_id = #{user.user_id}
        </where>
    </delete>

    <delete id="deleteUserByAccount"
            parameterType="fun.neverth.bean.po.User">
        delete from <include refid="tb"></include>
        <where>
            and user_account = #{user.user_account}
        </where>
    </delete>

    <update id="updateUserById"
            parameterType="fun.neverth.bean.po.User">
        update <include refid="tb"></include>
        <set>
            user_account = #{user1.user_account} ,
            user_passw = #{user1.user_passw} ,
        </set>
        <where>
            and user_id = #{user.user_id}
        </where>
    </update>

    <update id="updateUserByAccount"
            parameterType="fun.neverth.bean.po.User">
        update <include refid="tb"></include>
        <set>
            <if test="user.user_account != user1.user_account">
                user_account = #{user1.user_account} ,
            </if>
            <if test="user.user_passw != User1.user_passw">
                user_passw = #{user1.user_passw} ,
            </if>
            <if test="user.user_last_login != User1.user_last_login">
                user_last_login = #{user1.user_last_login} ,
            </if>
        </set>
        <where>
            and user_account = #{user.user_account}
        </where>
    </update>

</mapper>